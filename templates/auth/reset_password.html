{% extends "base.html" %}

{% block title %}Reset Password{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/auth.css') }}">
<style>
    body {
        background-color: #f8f9fa; /* Light background for contrast */
        font-family: Arial, sans-serif; /* Use a clean font */
    }
    .auth-container {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh; /* Full height for centering */
    }
    .auth-card {
        max-width: 400px; /* Set a consistent width */
        padding: 40px; /* Increased padding for a spacious feel */
        border: 1px solid #ced4da;
        border-radius: 10px;
        background-color: #ffffff; /* White background for the card */
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    }
    .auth-header {
        text-align: center;
        margin-bottom: 30px; /* Space below the header */
    }
    .auth-header h2 {
        font-weight: bold;
        color: #6D4C41; /* Match the primary color */
        margin: 0; /* Remove default margin */
        font-size: 1.8rem; /* Increase font size for better visibility */
    }
    .form-group {
        margin-bottom: 25px; /* Space between form fields */
    }
    .form-control {
        border: 1px solid #ced4da;
        border-radius: 5px;
        padding: 15px; /* Increased padding for comfort */
        transition: border-color 0.3s, box-shadow 0.3s; /* Smooth transition */
        font-size: 1rem; /* Increase font size for better readability */
    }
    .form-control:focus {
        border-color: #6D4C41; /* Match the primary color */
        box-shadow: 0 0 5px rgba(109, 76, 65, 0.5);
        outline: none; /* Remove default outline */
    }

    .alert {
        margin-top: 10px;
        font-size: 0.9rem; /* Slightly smaller font for alerts */
    }
    .password-requirements {
        font-size: 14px;
        color: #666;
        margin-top: 5px;
    }
    .password-requirements ul {
        list-style: none;
        padding-left: 0;
        margin-top: 5px;
    }
    .password-requirements li {
        margin-bottom: 3px;
        display: flex;
        align-items: center;
    }
    .password-requirements li::before {
        content: "â€¢";
        color: #6D4C41;
        margin-right: 5px;
    }
    .password-toggle {
        cursor: pointer;
        color: #6D4C41;
    }
</style>
{% endblock %}

{% block content %}
<div class="auth-container">
    <div class="auth-card">
        <div class="auth-header">
            <h2>Reset Password</h2>
            <p>Please enter your new password below.</p>
        </div>

        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }}">{{ message }}</div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <form method="POST" id="resetPasswordForm">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            <div class="form-group">
                <label for="new_password">New Password</label>
                <div class="input-group">
                    <input type="password" class="form-control" id="new_password" name="new_password" 
                           placeholder="Enter new password" required>
                    <div class="input-group-append">
                        <span class="input-group-text bg-white border-left-0" style="height:51px;">
                            <i class="fa fa-eye password-toggle" id="toggleNewPassword"></i>
                        </span>
                    </div>
                </div>
                <div class="password-requirements">
                    <span>Password must:</span>
                    <ul>
                        <li>Be at least 6 characters long</li>
                        <li>Contain at least one number</li>
                        <li>Contain at least one letter</li>
                    </ul>
                </div>
            </div>
            <div class="form-group">
                <label for="confirm_password">Confirm Password</label>
                <div class="input-group">
                    <input type="password" class="form-control" id="confirm_password" name="confirm_password" 
                           placeholder="Confirm new password" required>
                    <div class="input-group-append">
                        <span class="input-group-text bg-white border-left-0" style="height:51px;">
                            <i class="fa fa-eye password-toggle" id="toggleConfirmPassword"></i>
                        </span>
                    </div>
                </div>
            </div>
            <button type="submit" class="reset-button">Reset Password</button>
        </form>
    </div>
</div>

<script>
// Password visibility toggle
document.getElementById('toggleNewPassword').addEventListener('click', function() {
    const input = document.getElementById('new_password');
    input.type = input.type === 'password' ? 'text' : 'password';
    this.classList.toggle('fa-eye-slash');
});

document.getElementById('toggleConfirmPassword').addEventListener('click', function() {
    const input = document.getElementById('confirm_password');
    input.type = input.type === 'password' ? 'text' : 'password';
    this.classList.toggle('fa-eye-slash');
});

// Form validation
document.getElementById('resetPasswordForm').addEventListener('submit', function(e) {
    const newPassword = document.getElementById('new_password').value;
    const confirmPassword = document.getElementById('confirm_password').value;

    // Check password length
    if (newPassword.length < 6) {
        e.preventDefault();
        alert('Password must be at least 6 characters long.');
        return;
    }

    // Check if password contains at least one number and one letter
    if (!/\d/.test(newPassword) || !/[a-zA-Z]/.test(newPassword)) {
        e.preventDefault();
        alert('Password must contain at least one number and one letter.');
        return;
    }

    // Check if passwords match
    if (newPassword !== confirmPassword) {
        e.preventDefault();
        alert('Passwords do not match. Please try again.');
        return;
    }
});
</script>
{% endblock %}
