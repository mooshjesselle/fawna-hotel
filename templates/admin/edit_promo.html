{% extends 'admin/base_admin.html' %}
{% block admin_content %}
<style>
.light-button {
    background: linear-gradient(135deg, #42A5F5, #64B5F6);
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 4px;
    cursor: pointer;
    transition: background 0.3s;
}
.light-button:hover, .light-button:focus {
    background: linear-gradient(135deg, #2196F3, #42A5F5);
    color: white;
    text-decoration: none;
}
/* Toggle Switch Styles */
.form-switch {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 1rem;
}
.form-switch .form-check-input {
    width: 2.5em;
    height: 1.3em;
    border-radius: 1em;
    background-color: #e9ecef;
    border: 1px solid #bdbdbd;
    transition: background 0.3s, border 0.3s;
    position: relative;
    appearance: none;
    outline: none;
    cursor: pointer;
}
.form-switch .form-check-input:checked {
    background-color: #42A5F5;
    border-color: #42A5F5;
}
.form-switch .form-check-input:before {
    content: '';
    position: absolute;
    top: 2px;
    left: 2px;
    width: 1em;
    height: 1em;
    border-radius: 50%;
    background: #fff;
    transition: transform 0.3s;
}
.form-switch .form-check-input:checked:before {
    transform: translateX(1.2em);
}
</style>
<div class="container mt-4">
    <h2>{{ 'Edit Promo' if promo else 'Add Promo' }}</h2>
    <form method="post" enctype="multipart/form-data">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <div class="mb-3">
            <label for="title" class="form-label">Title</label>
            <input type="text" class="form-control" id="title" name="title" value="{{ promo.title if promo else '' }}" required>
        </div>
        <div class="mb-3">
            <label for="description" class="form-label">Description</label>
            <textarea class="form-control" id="description" name="description" rows="3" required>{{ promo.description if promo else '' }}</textarea>
        </div>
        <div class="mb-3">
            <label for="image" class="form-label">Promo Image</label>
            <input class="form-control" type="file" id="image" name="image" accept="image/*">
            {% if promo and promo.image %}
            <div class="mt-2">
                <img src="{{ url_for('static', filename=promo.image) }}" alt="Promo Image" style="max-width: 200px;">
            </div>
            {% else %}
            <div class="mt-2 d-flex justify-content-center align-items-center" style="height: 120px; width: 200px; background: #f8f9fa; border: 1px dashed #ccc; border-radius: 8px;">
                <i class="fas fa-bed fa-3x text-secondary"></i>
            </div>
            {% endif %}
        </div>
        <div class="form-switch">
            <input class="form-check-input" type="checkbox" id="is_active" name="is_active" {% if promo and promo.is_active %}checked{% endif %}>
            <label class="form-check-label" for="is_active">Available for booking</label>
        </div>
        <div class="mb-3">
            <label for="start_date" class="form-label">Start Date</label>
            <input type="date" class="form-control" id="start_date" name="start_date" value="{{ promo.start_date if promo else '' }}" required>
        </div>
        <div class="mb-3">
            <label for="end_date" class="form-label">End Date</label>
            <input type="date" class="form-control" id="end_date" name="end_date" value="{{ promo.end_date if promo else '' }}" required>
        </div>
        <div class="mb-3">
            <label for="discount_percentage" class="form-label">Discount Percentage (%)</label>
            <input type="number" class="form-control" id="discount_percentage" name="discount_percentage" min="0" max="100" step="0.01" value="{{ promo.discount_percentage if promo else 0 }}" required>
        </div>
        <div class="mb-3">
            <label class="form-label">Applicable Rooms</label>
            <div class="row">
                {% for room in all_rooms %}
                <div class="col-md-4">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" name="room_ids" value="{{ room.id }}" id="room_{{ room.id }}" {% if room.id in selected_room_ids %}checked{% endif %}>
                        <label class="form-check-label" for="room_{{ room.id }}">
                            <i class="fas fa-bed me-1"></i> Room {{ room.room_number }} ({{ room.room_type.name }})
                        </label>
                    </div>
                </div>
                {% endfor %}
            </div>
            <div class="form-text">Check all rooms this promo should apply to.</div>
        </div>
        <button type="submit" class="light-button">
            {{ 'Update Promo' if promo else 'Add Promo' }}
        </button>
        <a href="{{ url_for('admin_promos') }}" class="btn btn-secondary ms-2">
            Cancel
        </a>
    </form>
</div>
{% endblock %} 